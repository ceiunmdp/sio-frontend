<div class="pb-4">
   <mat-card [ngClass.lt-sm]="'mt-6'" [ngClass]="['card-shadow', 'mt-5']">
      <mat-card-header class="pl-0 ml-0">
         <div fxFlex="100" fxLayout="column wrap" class="pl-0 ml-0">
            <button fxFlexAlign="end" mat-icon-button>
               <mat-icon class="text-primary" (click)="onReloadOrders()">refresh</mat-icon>
            </button>
            <mat-form-field>
               <input matInput (keyup)="applyFilter($event.target.value)" placeholder="Búsqueda rápida" />
            </mat-form-field>
         </div>
      </mat-card-header>
      <mat-card-content>
         <div fxLayout="column wrap">
            <table matSort fxFlex="100%" mat-table [dataSource]="dataOrders" class="mat-elevation-z0 mt-0">
               <!-- id Column -->
               <ng-container matColumnDef="id">
                  <th mat-sort-header mat-header-cell *matHeaderCellDef>Id</th>
                  <td mat-cell *matCellDef="let element">
                     {{ element.id }}
                  </td>
               </ng-container>

               <!-- dni Column -->
               <ng-container matColumnDef="dni">
                  <th mat-sort-header mat-header-cell *matHeaderCellDef>DNI</th>
                  <td mat-cell *matCellDef="let element">
                     {{ element.user.dni }}
                  </td>
               </ng-container>

               <!-- dateOrdered Column -->
               <ng-container matColumnDef="dateOrdered">
                  <th mat-sort-header mat-header-cell *matHeaderCellDef>Fecha de solicitud</th>
                  <td mat-cell *matCellDef="let element">
                     {{ element.dateOrdered | date: "dd/MM/yy H:mm" }}
                  </td>
               </ng-container>
               <!-- name Column -->
               <ng-container matColumnDef="nameAndSurname">
                  <th mat-sort-header mat-header-cell *matHeaderCellDef>Nombre</th>
                  <td mat-cell *matCellDef="let element">
                     {{ element.user.name + " " + element.user.surname }}
                  </td>
               </ng-container>

               <!-- totalPrice Column -->
               <ng-container matColumnDef="totalPrice">
                  <th mat-header-cell *matHeaderCellDef>Precio</th>
                  <td mat-cell *matCellDef="let element">
                     {{ element.totalPrice | moneda }}
                  </td>
               </ng-container>

               <!-- amountPaid Column -->
               <ng-container matColumnDef="amountPaid">
                  <th mat-header-cell *matHeaderCellDef>Abonado</th>
                  <td mat-cell *matCellDef="let element">
                     {{ element.amountPaid | moneda }}
                  </td>
               </ng-container>

               <!-- state Column -->
               <ng-container matColumnDef="state">
                  <th mat-header-cell *matHeaderCellDef mat-sort-header>Estado</th>
                  <td mat-cell *matCellDef="let element">
                     {{ element.state.name }}
                  </td>
               </ng-container>

               <!-- Actions Column -->
               <ng-container matColumnDef="actions">
                  <th mat-header-cell *matHeaderCellDef></th>
                  <td mat-cell *matCellDef="let element">
                     <button mat-icon-button (click)="openBottomSheet(element.id)">
                        <mat-icon [color]="'primary'">loupe</mat-icon>
                     </button>
                     <button
                        *ngIf="element.state.id !== ORDER_STATES.CANCELADO && element.state.id !== ORDER_STATES.ENTREGADO"
                        mat-icon-button [matMenuTriggerFor]="menuActions" [matMenuTriggerData]="{ order: element }">
                        <mat-icon [color]="'primary'">menu</mat-icon>
                     </button>
                     <!-- <button mat-raised-button color="accent" (click)="openBottomSheet(element.id)">Ver más</button> -->
                  </td>
               </ng-container>

               <!-- Disclaimer column -->
               <!-- <ng-container matColumnDef="disclaimer1">
                  <td mat-footer-cell *matFooterCellDef colspan="2" class="text-accent-lighter">
                     Pedidos en espera: {{ this.waitingOrders() }}
                  </td>
               </ng-container>
               <ng-container matColumnDef="disclaimer2">
                  <td mat-footer-cell *matFooterCellDef colspan="2" style="color: #900000;">
                     <b>Pedidos en proceso: {{ this.ordersInProcess() }}</b>
                  </td>
               </ng-container>
               <ng-container matColumnDef="disclaimer3">
                  <td mat-footer-cell *matFooterCellDef colspan="2" style="color: #900000;">
                     <b>Pedidos para retirar: {{ this.ordersToDeliver() }}</b>
                  </td>
               </ng-container> -->

               <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
               <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
               <!-- <tr mat-footer-row *matFooterRowDef="['disclaimer1']" class="example-second-footer-row"></tr> -->
            </table>

            <mat-paginator fxFlex="100" pageSize="10" [pageSizeOptions]="[5, 10, 25, 100]" showFirstLastButtons
               firstPageLabel="Primera página" lastPageLabel="Última página" nextPageLabel="Página siguiente"
               previousPageLabel="Página anterior"></mat-paginator>
         </div>
      </mat-card-content>
   </mat-card>
</div>
<mat-menu #menuActions="matMenu">
   <ng-template matMenuContent let-order="order">
      <button *ngIf="order.state.id === ORDER_STATES.EN_PROCESO || order.state.id == ORDER_STATES.SOLICITADO"
         mat-menu-item fxLayoutAlign="center stretch"
         (click)="onClickChangeStateOrder(this.ORDER_STATES.CANCELADO, order)">
         Cancelar
      </button>
      <button *ngIf="order.state.id === ORDER_STATES.PARA_RETIRAR || order.state.id == ORDER_STATES.NO_ENTREGADO"
         mat-menu-item fxLayoutAlign="center stretch"
         (click)="onClickChangeStateOrder(this.ORDER_STATES.ENTREGADO, order)">
         Entregar
      </button>
      <button *ngIf="order.state.id === ORDER_STATES.PARA_RETIRAR" mat-menu-item fxLayoutAlign="center stretch"
         (click)="onClickChangeStateOrder(this.ORDER_STATES.NO_ENTREGADO, order)">
         Sin entregar
      </button>
   </ng-template>
</mat-menu>
<!-- <cei-alert-error #alertError></cei-alert-error> -->