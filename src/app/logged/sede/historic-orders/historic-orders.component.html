<cei-card-table [metaData]="this.metaDataOrders" (page)="onPaginatorEvent($event)">
    <!-- <div controlButtons fxLayout="row" fxLayoutGap="15px">
        <button mat-icon-button [matMenuTriggerFor]="menuUser">
            <mat-icon [color]="'primary'" class="medium">scatter_plot</mat-icon>
        </button>
    </div> -->
    <cei-text-searching-input
        filterInputs
        fxFlex="90"
        [placeholder]="'Buscar por nombre o por dni'"
        [label]="'Ingrese el nÃºmero de pedido'"
        [inputFilterValue]="this.inputFilterValue"
        (onSearch)="this.inputFilterValue = $event; this.onSearch($event)"
    >
    </cei-text-searching-input>
    <table table fxFlex="100" mat-table *ngIf="!this.isLoadingGetOrders; else loadingDiv" [dataSource]="dataSourceOrders">
        <!-- ID Column -->
        <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef>Id</th>
            <td mat-cell *matCellDef="let data">{{ data.id }}</td>
        </ng-container>
        <!-- Date Column -->
        <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef>Fecha de solicitud</th>
            <td mat-cell *matCellDef="let data">{{ data.tracking[0].timestamp | date: 'dd/MM/yyyy' }}</td>
        </ng-container>

        <!-- DNI Column -->
        <ng-container matColumnDef="dni">
            <th mat-header-cell *matHeaderCellDef>DNI</th>
            <td mat-cell *matCellDef="let data">{{ data.student.dni }}</td>
        </ng-container>

        <!-- Student Column -->
        <ng-container matColumnDef="student">
            <th mat-header-cell *matHeaderCellDef>Nombre</th>
            <td mat-cell *matCellDef="let data">{{ data.student.display_name }}</td>
        </ng-container>

        <!-- state Column -->
        <ng-container matColumnDef="state">
            <th mat-header-cell *matHeaderCellDef>Estado</th>
            <td mat-cell *matCellDef="let data">{{ data.state.name }}</td>
        </ng-container>

        <!-- price Column -->
        <ng-container matColumnDef="totalPrice">
            <th mat-header-cell *matHeaderCellDef>Precio</th>
            <td mat-cell *matCellDef="let data">{{ data.total | moneda }}</td>
        </ng-container>

        <!-- actions Column -->
        <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let element">
                <!-- Detail button -->
                <button [disabled]="element.isLoading" mat-icon-button (click)="openBottomSheet(element)">
                    <mat-icon *ngIf="!element.isLoading; else loadingIcon" [color]="'primary'">loupe</mat-icon>
                    <ng-template #loadingIcon>
                        <mat-icon>
                            <mat-spinner color="accent" diameter="20"> </mat-spinner>
                        </mat-icon>
                    </ng-template>
                </button>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns" class="bg-on-hover"></tr>
    </table>
</cei-card-table>
<ng-template #loadingDiv>
    <app-spinner fxFlex="100" fxLayoutAlign="center start"></app-spinner>
</ng-template>
<cei-alert-error #alertError></cei-alert-error>
