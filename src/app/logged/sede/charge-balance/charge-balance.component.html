<div *ngIf="this.step == 1" fxLayout="column wrap">
   <mat-card class="card-shadow" fxFlex="100" [ngClass.lt-md]="{ 'border-radius-0': true }">
      <mat-card-header>
         <mat-card-subtitle> <span class="mat-h3">Filtros</span> <br /><br /> </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
         <div fxFlex="100" fxLayout="column wrap">
            <form [formGroup]="this.findUserForm" *ngIf="!!this.findUserForm" (submit)="this.getUsers()">
               <div fxLayout="row wrap" fxLayoutAlign="space-around start">
                  <cei-text-input
                     [hint]="'Opcional'"
                     [form]="this.findUserForm"
                     [name]="this.NAME"
                     [label]="'Nombre'"
                  ></cei-text-input>
                  <cei-text-input
                     [hint]="'Opcional'"
                     [form]="this.findUserForm"
                     [name]="this.SURNAME"
                     [label]="'Apellido'"
                  ></cei-text-input>
                  <cei-number-input [hint]="'Opcional'" [form]="this.findUserForm" [name]="this.DNI" [label]="'DNI'">
                  </cei-number-input>
                  <div>
                     <button type="submit" [disabled]="!findUserForm.valid" mat-raised-button color="primary">
                        Buscar
                     </button>
                  </div>
               </div>
            </form>
            <!-- Table students -->
            <div
               class="mt-3 mb-2"
               *ngIf="this.step === 1 && !!dataUsers && dataUsers.data.length > 0"
               fxLayout="column"
            >
               <div class="separator separator-center mb-1">
                  <span class="mx-2 text-secondary">Listado de estudiantes</span>
               </div>
               <div fxLayout="column wrap">
                  <table fxFlex="100" mat-table [dataSource]="dataUsers" class="mat-elevation-z0 mb-2">
                     <!-- id Column -->
                     <ng-container matColumnDef="id">
                        <th mat-header-cell *matHeaderCellDef>Id</th>
                        <td mat-cell *matCellDef="let element">
                           {{ element.id }}
                        </td>
                     </ng-container>

                     <!-- dni Column -->
                     <ng-container matColumnDef="dni">
                        <th mat-header-cell *matHeaderCellDef>DNI</th>
                        <td mat-cell *matCellDef="let element">
                           {{ element.dni }}
                        </td>
                     </ng-container>

                     <!-- name Column -->
                     <ng-container matColumnDef="name">
                        <th mat-header-cell *matHeaderCellDef>Nombre</th>
                        <td mat-cell *matCellDef="let element">
                           {{ element.name }}
                        </td>
                     </ng-container>

                     <!-- surname Column -->
                     <ng-container matColumnDef="surname">
                        <th mat-header-cell *matHeaderCellDef>Apellido</th>
                        <td mat-cell *matCellDef="let element">
                           {{ element.surname }}
                        </td>
                     </ng-container>

                     <!-- balance Column -->
                     <ng-container matColumnDef="balance">
                        <th mat-header-cell *matHeaderCellDef>Saldo</th>
                        <td mat-cell *matCellDef="let element">
                           {{ element.balance | moneda }}
                        </td>
                     </ng-container>

                     <!-- Actions Column -->
                     <ng-container matColumnDef="actions">
                        <th mat-header-cell *matHeaderCellDef></th>
                        <td mat-cell *matCellDef="let element">
                           <button mat-button color="primary" (click)="this.onClickChargeBalance(element.id)">
                              <mat-icon class="mat-18">attach_money</mat-icon>
                              Cargar saldo
                           </button>
                        </td>
                     </ng-container>

                     <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                     <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
                  </table>

                  <mat-paginator fxFlex="100" pageSize="10" showFirstLastButtons></mat-paginator>
               </div>
            </div>
         </div>
      </mat-card-content>
   </mat-card>
</div>

<form
   [formGroup]="this.chargeBalanceForm"
   *ngIf="this.step === 2"
   fxLayout="row wrap"
   fxLayoutAlign="center center"
   (submit)="this.chargeBalance()"
>
   <mat-card fxFlex="80">
      <mat-card-header>
         <mat-card-title>
            Carga de saldo
         </mat-card-title>
         <mat-card-subtitle>
            {{ this.chargeBalanceUser.dni }}
            {{ this.chargeBalanceUser.name }}
            {{ this.chargeBalanceUser.surname }}
         </mat-card-subtitle>
      </mat-card-header>
      <mat-divider [inset]="true"></mat-divider>
      <mat-card-content class="mt-3" fxLayout="column">
         <cei-number-input
            [form]="this.chargeBalanceForm"
            [name]="this.MONEY"
            [minValue]="1"
            [placeholder]="'Saldo a cargar'"
         >
         </cei-number-input>
      </mat-card-content>
      <mat-card-actions>
         <button (click)="this.cancelCharge()" fxFlex="50%" mat-raised-button color="warn">Cancelar</button>
         <button type="submit" [disabled]="!chargeBalanceForm.valid" fxFlex="50%" mat-raised-button color="primary">
            Cargar
         </button>
      </mat-card-actions>
   </mat-card>
</form>

<swal #responseSwal [swalOptions]="this.swalOptions"> </swal>
