<div class="pb-4">

   <cei-card-table [metaData]="this.metaDataOrders" [title]="this.historicOrdersShow ? 'Mi historial de pedidos' : 'Mis pedidos activos'" (page)="onPaginatorEvent($event)">
        <div controlButtons fxLayout="row" fxLayoutGap="15px">
            <button mat-icon-button [matMenuTriggerFor]="menuUser">
               <mat-icon [color]="'primary'" class="medium">scatter_plot</mat-icon>
            </button>
        </div>
        <!-- <cei-text-searching-input filterInputs fxFlex="100" [placeholder]="'Búsqueda rápida'"
            [label]="'Ingrese el número de pedido'" [inputFilterValue]="this.inputFilterValue"
            (onSearch)="this.inputFilterValue = $event;this.onSearch($event)">
        </cei-text-searching-input> -->
        <ng-container table *ngIf="!this.isLoadingGetOrders; else loadingDiv">
          <table fxFlex="100" mat-table *ngIf="this.dataSourceOrders.data.length > 0"
              [dataSource]="dataSourceOrders">
              <!-- ID Column -->
              <ng-container matColumnDef="id">
                 <th mat-header-cell *matHeaderCellDef>Id</th>
                 <td mat-cell *matCellDef="let data">{{ data.id_number }}</td>
              </ng-container>
              <!-- Date Column -->
              <ng-container matColumnDef="date">
                 <th mat-header-cell *matHeaderCellDef>Fecha</th>
                 <td mat-cell *matCellDef="let data">{{ data.tracking[0].timestamp | date: "dd/MM/yyyy" }}</td>
              </ng-container>

              <!-- name Column -->
              <ng-container matColumnDef="campus">
                 <th mat-header-cell *matHeaderCellDef>Sede</th>
                 <td mat-cell *matCellDef="let data">{{ data.campus.name }}</td>
              </ng-container>

              <!-- state Column -->
              <ng-container matColumnDef="state">
                 <th mat-header-cell *matHeaderCellDef>Estado</th>
                 <td mat-cell *matCellDef="let data">{{ data.state.name }}</td>
              </ng-container>

              <!-- subtotal Column -->
                <ng-container matColumnDef="subtotal">
                    <th mat-header-cell *matHeaderCellDef>Subtotal</th>
                    <td mat-cell *matCellDef="let data">
                      {{ data.subtotal | moneda }}
                      <span class="text-primary" *ngIf="data.discount">
                        (-{{ data.discount | moneda}})
                      </span>
                    </td>
                </ng-container>

              <!-- price Column -->
              <ng-container matColumnDef="totalPrice">
                 <th mat-header-cell *matHeaderCellDef>Precio</th>
                 <td mat-cell *matCellDef="let data">
                   <b>
                     {{ data.total | moneda }}
                   </b>
                  </td>
              </ng-container>

              <!-- actions Column -->
              <ng-container matColumnDef="actions">
                 <th mat-header-cell *matHeaderCellDef></th>
                 <td mat-cell *matCellDef="let data">
                    <!-- Detail button -->

                    <button (click)="onClickOrderDetail(data)" mat-icon-button color="primary">
                       <mat-icon class="medium " [color]="'primary'" matTooltip="Ver detalles del pedido">loupe</mat-icon>
                    </button>
                 </td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns" class="bg-on-hover">
              </tr>
          </table>
          <div *ngIf="this.dataSourceOrders.data.length === 0" fxLayout="column" fxLayoutAlign="center center" class="pys-5">
            <ng-lottie width="300px" [options]="noOrdersLottie"></ng-lottie>
            <div fxLayout="column" fxLayoutAlign="center center">
              <h3>
                {{this.historicOrdersShow ? 'Aún no finalizaste ningún pedido' : 'No se encontraron pedidos activos'}}
              </h3>
              <button mat-flat-button routerLink="{{ this.rootPath + ROUTES.NEW_ORDER }}" color="primary">
                <mat-icon class="mrs-2">add</mat-icon>
                <span>Solicitar nuevo pedido</span>
              </button>
            </div>
          </div>
        </ng-container>

    </cei-card-table>



    eyJhbGciOiJSUzI1NiIsImtpZCI6ImYwNTM4MmFlMTgxYWJlNjFiOTYwYjA1Yzk3ZmE0MDljNDdhNDQ0ZTciLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL3NlY3VyZXRva2VuLmdvb2dsZS5jb20vaWNlaS1kM2M5NCIsImF1ZCI6ImljZWktZDNjOTQiLCJhdXRoX3RpbWUiOjE2MzM5NzE0NzcsInVzZXJfaWQiOiJWMXpCc0tLUHI0VURrY0RTb1luQjJKOG5BWnkxIiwic3ViIjoiVjF6QnNLS1ByNFVEa2NEU29ZbkIySjhuQVp5MSIsImlhdCI6MTYzMzk3MTQ3NywiZXhwIjoxNjMzOTc1MDc3LCJlbWFpbCI6ImFzc2ZmQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiZmlyZWJhc2UiOnsiaWRlbnRpdGllcyI6eyJlbWFpbCI6WyJhc3NmZkBnbWFpbC5jb20iXX0sInNpZ25faW5fcHJvdmlkZXIiOiJwYXNzd29yZCJ9fQ.mCwBwelvdSOu3T-yDvK99uTfPzEfaT2fgx-EAWJvYqtvpBCdCCvIQvJ0sJq6DfDDL6LFOBbEf6zcs5-EVk6QZOp4akbaS6CcdIQ1UjTulo28LAqoFROGsptR1WLWtMw9mYL917UYfjpo92o7RlMEuxlsNmx59VH9WLlJTEMUspGaDb1tS6LsKV6kRh36JVDHqWdj7XMXZauTFC11d3buNuG9pBesaV9-T9WCWWllEBnz7c1HcLQjZlVgOErl76pTiLagwXTRRVoy1YigSxNuvTPUnI0MSvzSVlAglKtHP_8qFQOc5mMToyu4Q39FWM4X0mrhswu5y1PLH_miZ3NgIg

    eyJhbGciOiJSUzI1NiIsImtpZCI6ImYwNTM4MmFlMTgxYWJlNjFiOTYwYjA1Yzk3ZmE0MDljNDdhNDQ0ZTciLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoidHQiLCJpZCI6IjE4ZDhmZjY5LWNkYTQtNGQ3My1iZjFlLWMyNzMyYWNiZjAzZCIsInJvbGUiOiJTdHVkZW50IiwiaXNzIjoiaHR0cHM6Ly9zZWN1cmV0b2tlbi5nb29nbGUuY29tL2ljZWktZDNjOTQiLCJhdWQiOiJpY2VpLWQzYzk0IiwiYXV0aF90aW1lIjoxNjMzOTcxNTE3LCJ1c2VyX2lkIjoiVjF6QnNLS1ByNFVEa2NEU29ZbkIySjhuQVp5MSIsInN1YiI6IlYxekJzS0tQcjRVRGtjRFNvWW5CMko4bkFaeTEiLCJpYXQiOjE2MzM5NzE1MTcsImV4cCI6MTYzMzk3NTExNywiZW1haWwiOiJhc3NmZkBnbWFpbC5jb20iLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsImZpcmViYXNlIjp7ImlkZW50aXRpZXMiOnsiZW1haWwiOlsiYXNzZmZAZ21haWwuY29tIl19LCJzaWduX2luX3Byb3ZpZGVyIjoicGFzc3dvcmQifX0.U-42scEYy5DxH9rxqUXuIyUfsmZIMhFWC1TmyhGY3Ol0AALRNIzzbOWfHr8YvIH2PhTfnt3-_4rjRRtNVM7sw8N7n54j75g64OGvLtqqT1_DHSSk_GOO-7xV5nXv66FG-qYDi276LMRulhfe8PZxCvw5G3b11Q5sLDUyJd0OuNVzlC5LZGdj3CR7Q3wOOoJouelyptObh_r3-zpTcztg4QSSMMQrye_BJP-YQ305FLGlVipGC4RegPcrxvDnExWfrQ3VIf2q8b_yNyRcGLgrJvnMpo-RZqbSXH_a_WBina2OLlDtO5PWgm1NHxlMaViuvLJqPxKkzpLPthmUusEPog

</div>
<mat-menu #menuUser="matMenu" style="min-width: 600px !important;">
   <button *ngIf="!this.historicOrdersShow; else activeOrdersShow" mat-menu-item fxLayoutAlign="start center"
      (click)="this.getHistoricOrders()">
      <mat-icon>find_replace</mat-icon>
      <span>Mostrar el historial de pedidos</span>
   </button>
   <ng-template #activeOrdersShow>
      <button (click)="getActiveOrders()" mat-menu-item fxLayoutAlign="start center">
         <mat-icon>youtube_searched_for</mat-icon>
         <span>Mostrar sólo los pedidos activos</span>
      </button>
   </ng-template>
</mat-menu>
<ng-template #loadingDiv>
    <app-spinner fxFlex="100" fxLayoutAlign="center start"></app-spinner>
</ng-template>
<cei-alert-error #alertError></cei-alert-error>
